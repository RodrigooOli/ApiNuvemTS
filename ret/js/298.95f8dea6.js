(self["webpackChunkret"]=self["webpackChunkret"]||[]).push([[298],{3298:(t,l,e)=>{"use strict";e.r(l),e.d(l,{default:()=>jt});var a=e(3673),i=e(2323),o=e(8880);const s={class:"q-pa-md"},n=(0,a.Wm)("div",{class:"flex justify-between"},[(0,a.Wm)("span",{class:"text-blue text-h5"},"Suprimentos e sangrias")],-1),r=(0,a.Wm)("br",null,null,-1),u={class:"flex items-center"},m=(0,a.Wm)("span",{class:"gt-sm q-pl-sm"},"Imprimir",-1),d=(0,a.Wm)("span",{class:"gt-sm q-pl-sm"},"Exportar",-1),p=(0,a.Wm)("span",null,"Excel",-1),c=(0,a.Wm)("span",null,"Planilhas Online",-1),w=(0,a.Wm)("br",null,null,-1),g=(0,a.Wm)("br",null,null,-1),f={class:"q-pa-md bg-grey-1 radius-10 text-blue text-bold"},b=(0,a.Wm)("br",null,null,-1),h={style:{display:"flex",width:"100%"}},y=(0,a.Wm)("div",{style:{flex:"1"}},null,-1),W=(0,a.Uk)(" FILTROS "),v=(0,a.Wm)("label",null,"Data Início",-1),x=(0,a.Wm)("br",null,null,-1),j=(0,a.Wm)("label",null,"Data Fim",-1),k=(0,a.Wm)("br",null,null,-1),C=(0,a.Wm)("label",null,"Tipo emissão",-1),q=(0,a.Wm)("br",null,null,-1),_=(0,a.Uk)(" Gerar relatório "),z=(0,a.Wm)("iframe",{id:"iframe_print",style:{display:"none"}},null,-1),S={id:"testeimpressao",style:{display:"none"}},$={style:{display:"flex","justify-content":"start","align-items":"center",color:"#70a0ff","font-family":"sans-serif"}},R={style:{padding:"10px"}},I={style:{display:"flex","justify-content":"flex-end","font-size":"14px","font-weight":"bold",color:"#70a0ff"}},T=(0,a.Wm)("div",{style:{width:"100%",height:"1px","background-color":"#70a0ff"}},null,-1),D={style:{padding:"10px",color:"#70a0ff","font-weigth":"600","font-size":"24px"}},Z=(0,a.Wm)("br",null,null,-1),U={style:{padding:"10px",color:"#70a0ff","font-weigth":"600","font-size":"18px"}},F=(0,a.Wm)("br",null,null,-1),Q=(0,a.Wm)("div",{style:{flex:"1"}},null,-1),H=(0,a.Wm)("div",{style:{flex:"1"}},null,-1),K=(0,a.Wm)("div",{style:{flex:"1"}},null,-1);function O(t,l,e,O,Y,N){const V=(0,a.up)("q-btn"),L=(0,a.up)("q-item-section"),G=(0,a.up)("q-item"),E=(0,a.up)("q-list"),M=(0,a.up)("q-menu"),A=(0,a.up)("q-space"),P=(0,a.up)("q-separator"),B=(0,a.up)("q-td"),J=(0,a.up)("q-tr"),X=(0,a.up)("q-tooltip"),tt=(0,a.up)("q-table"),lt=(0,a.up)("q-toolbar-title"),et=(0,a.up)("q-toolbar"),at=(0,a.up)("q-input"),it=(0,a.up)("q-select"),ot=(0,a.up)("q-form"),st=(0,a.up)("q-drawer"),nt=(0,a.Q2)("ripple");return(0,a.wg)(),(0,a.j4)("div",s,[n,r,(0,a.Wm)("div",u,[(0,a.Wm)(V,{class:"q-mb-sm bg-blue text-white on-left",icon:"print",onClick:t.imprimir},{default:(0,a.w5)((()=>[m])),_:1},8,["onClick"]),(0,a.Wm)(V,{class:"q-mb-sm bg-blue text-white on-left",icon:"file_download"},{default:(0,a.w5)((()=>[d,(0,a.Wm)(M,null,{default:(0,a.w5)((()=>[(0,a.Wm)(E,null,{default:(0,a.w5)((()=>[(0,a.Wm)(G,{clickable:"",onClick:l[1]||(l[1]=l=>t.exportar(0))},{default:(0,a.w5)((()=>[(0,a.Wm)(L,null,{default:(0,a.w5)((()=>[p])),_:1})])),_:1}),(0,a.Wm)(G,{clickable:"",onClick:l[2]||(l[2]=l=>t.exportar(1))},{default:(0,a.w5)((()=>[(0,a.Wm)(L,null,{default:(0,a.w5)((()=>[c])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),(0,a.Wm)(A),(0,a.Wm)(V,{icon:"filter_list",label:"",class:"text-white bg-blue q-mb-sm",onClick:l[3]||(l[3]=l=>t.drawerFilters=!t.drawerFilters)})]),w,g,((0,a.wg)(!0),(0,a.j4)(a.HY,null,(0,a.Ko)(t.grupos,((l,e)=>((0,a.wg)(),(0,a.j4)("div",{key:e,class:"bg-grey-4 radius-10 q-mb-xl"},[(0,a.Wm)("span",f,(0,i.zw)(l.title),1),(0,a.Wm)(P,{class:"bg-grey-4"}),b,((0,a.wg)(!0),(0,a.j4)(a.HY,null,(0,a.Ko)(l.tabelas,((l,e)=>((0,a.wg)(),(0,a.j4)("div",{key:e},[(0,a.Wm)(tt,{separator:"none",rows:l.data,columns:t.columns,title:l.title,"rows-per-page-options":[0],visibleColumns:t.visibleColumns,class:"card q-mb-sm"},(0,a.Nv)({body:(0,a.w5)((l=>[(0,a.Wm)(J,{props:l},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.j4)(a.HY,null,(0,a.Ko)(t.columns.map((t=>t.name)).filter((l=>t.visibleColumns.includes(l))),(e=>((0,a.wg)(),(0,a.j4)(B,{key:e,align:t.columns.find((t=>t.name===e)).align||"",style:`width: calc(100vw / ${t.columns.filter((l=>t.visibleColumns.includes(l))).length}); padding: 10px; ${t.styles(l.row)}`},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(t.columns.find((t=>t.name===e)).format?t.columns.find((t=>t.name===e)).format(l.row[e],l.row):l.row[e]),1)])),_:2},1032,["align","style"])))),128))])),_:2},1032,["props"])])),bottom:(0,a.w5)((()=>[(0,a.Wm)("div",h,[y,(0,a.Wm)("span",null,(0,i.zw)(l.data.length)+" registro(s)",1)])])),_:2},[Object.keys(t.totaisColunas).length>0?{name:"bottom-row",fn:(0,a.w5)((l=>[(0,a.Wm)(J,{class:"bg-grey-3",props:l},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.j4)(a.HY,null,(0,a.Ko)(l.cols.map((t=>t.name)),(l=>((0,a.wg)(),(0,a.j4)(B,{align:"right",key:l,class:"text-bold",style:{"font-size":"12px",padding:"10px"}},{default:(0,a.w5)((()=>[(0,a.Uk)((0,i.zw)(t.totaisColunas[l]?t.totaisColunas[l](t.rows):"")+" ",1),t.totaisColunas[l]?((0,a.wg)(),(0,a.j4)(X,{key:0},{default:(0,a.w5)((()=>[(0,a.Uk)(" TOTAL "+(0,i.zw)(t.columns.find((t=>t.name===l)).label),1)])),_:2},1024)):(0,a.kq)("",!0)])),_:2},1024)))),128))])),_:2},1032,["props"])]))}:void 0]),1032,["rows","columns","title","visibleColumns"]),((0,a.wg)(!0),(0,a.j4)(a.HY,null,(0,a.Ko)(l.totais,((t,l)=>((0,a.wg)(),(0,a.j4)("div",{key:l,class:"card q-pa-md q-mb-md bg-white",align:"right"},[(0,a.Wm)("span",null,[(0,a.Uk)((0,i.zw)(t["label"])+" ",1),(0,a.Wm)("strong",null,(0,i.zw)(t["value"]),1)])])))),128))])))),128)),((0,a.wg)(!0),(0,a.j4)(a.HY,null,(0,a.Ko)(l.totais,((t,l)=>((0,a.wg)(),(0,a.j4)("div",{key:l,class:"card q-pa-md q-mb-md bg-white",align:"right"},[(0,a.Wm)("span",null,[(0,a.Uk)((0,i.zw)(t["label"])+" ",1),(0,a.Wm)("strong",null,(0,i.zw)(t["value"]),1)])])))),128))])))),128)),((0,a.wg)(!0),(0,a.j4)(a.HY,null,(0,a.Ko)(t.totais,((t,l)=>((0,a.wg)(),(0,a.j4)("div",{key:l,class:"card q-pa-md q-mb-md bg-white",align:"right"},[(0,a.Wm)("span",null,[(0,a.Uk)((0,i.zw)(t["label"])+" ",1),(0,a.Wm)("strong",null,(0,i.zw)(t["value"]),1)])])))),128)),(0,a.Wm)(st,{"show-if-above":"",modelValue:t.drawerFilters,"onUpdate:modelValue":l[7]||(l[7]=l=>t.drawerFilters=l),side:"right"},{default:(0,a.w5)((()=>[(0,a.Wm)(et,null,{default:(0,a.w5)((()=>[(0,a.Wm)(lt,null,{default:(0,a.w5)((()=>[W])),_:1})])),_:1}),(0,a.Wm)(E,null,{default:(0,a.w5)((()=>[(0,a.Wm)(G,null,{default:(0,a.w5)((()=>[(0,a.Wm)(L,null,{default:(0,a.w5)((()=>[(0,a.Wm)(ot,{onSubmit:(0,o.iM)(t.gerarRelatorio,["prevent","stop"]),style:{width:"100%","max-width":"400px"}},{default:(0,a.w5)((()=>[v,(0,a.Wm)(at,{type:"date",filled:"",modelValue:t.filtros.dataIni,"onUpdate:modelValue":l[4]||(l[4]=l=>t.filtros.dataIni=l)},null,8,["modelValue"]),x,j,(0,a.Wm)(at,{type:"date",filled:"",modelValue:t.filtros.dataFim,"onUpdate:modelValue":l[5]||(l[5]=l=>t.filtros.dataFim=l)},null,8,["modelValue"]),k,C,(0,a.Wm)(it,{filled:"",modelValue:t.filtros.tipo,"onUpdate:modelValue":l[6]||(l[6]=l=>t.filtros.tipo=l),options:t.tipoOptions},null,8,["modelValue","options"]),q,(0,a.wy)((0,a.Wm)(V,{color:"blue",class:"q-pa-md",type:"submit",style:{width:"100%"},onClick:t.closeMenuFiltros},{default:(0,a.w5)((()=>[_])),_:1},8,["onClick"]),[[nt]])])),_:1},8,["onSubmit"])])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"]),z,(0,a.Wm)("div",S,[(0,a.Wm)("div",$,[(0,a.Wm)("img",{src:"https://www.lsiconsultoria.com.br/images/logotipo_galileo_plus.png",alt:"Logotipo Galileo Plus",style:"height: 75.2px; width: 200px;"},null,4),(0,a.Wm)("div",R,[(0,a.Wm)("h2",null,(0,i.zw)(t.tipoGerado)+" do caixa",1),(0,a.Wm)("div",I,[(0,a.Wm)("span",null," Período: "+(0,i.zw)(new Date(`${t.filtros.dataIni} `).toLocaleDateString("pt-br"))+" - "+(0,i.zw)(new Date(`${t.filtros.dataFim} `).toLocaleDateString("pt-br")),1),(0,a.Wm)("span",null," | Gerado: "+(0,i.zw)(new Date(Date.now()).toLocaleString("pt-br"))+" por "+(0,i.zw)(t.$store.state.user.nome),1)])])]),T,((0,a.wg)(!0),(0,a.j4)(a.HY,null,(0,a.Ko)(t.grupos,((l,e)=>((0,a.wg)(),(0,a.j4)("div",{key:e,style:{margin:"20px"}},[(0,a.Wm)("span",D,(0,i.zw)(l.title),1),Z,((0,a.wg)(!0),(0,a.j4)(a.HY,null,(0,a.Ko)(l.tabelas,((l,e)=>((0,a.wg)(),(0,a.j4)("div",{key:e},[(0,a.Wm)("div",U,[F,(0,a.Wm)("span",null,(0,i.zw)(l.title),1)]),(0,a.Wm)("table",{style:`width: 100vw; font-size: calc(100% - ${t.printColumns.length/2}px);`},[(0,a.Wm)("thead",null,[(0,a.Wm)("tr",null,[((0,a.wg)(!0),(0,a.j4)(a.HY,null,(0,a.Ko)(t.printColumns,(l=>((0,a.wg)(),(0,a.j4)("th",{align:l.align,key:l.name,style:`width: calc(100vw / ${t.printColumns.length}); padding: 10px; background-color: #70a0ff99; color: #fff; `},(0,i.zw)(l.label),13,["align"])))),128))])]),(0,a.Wm)("tbody",null,[((0,a.wg)(!0),(0,a.j4)(a.HY,null,(0,a.Ko)(l.data,((l,e)=>((0,a.wg)(),(0,a.j4)("tr",{key:e,style:{height:"35px"}},[((0,a.wg)(!0),(0,a.j4)(a.HY,null,(0,a.Ko)(Object.keys(l),((e,o)=>((0,a.wg)(),(0,a.j4)("td",{key:e,align:t.printColumns[o].align,style:`border-bottom: 1px solid #c0c0c0; width: calc(100vw / ${t.printColumns.length}); padding: 10px; ${t.styles(l)}`},(0,i.zw)(t.printColumns[o].format?t.printColumns[o].format(l[e],l):l[e]),13,["align"])))),128))])))),128))])],4),((0,a.wg)(!0),(0,a.j4)(a.HY,null,(0,a.Ko)(l.totais,((t,l)=>((0,a.wg)(),(0,a.j4)("div",{key:l,style:{display:"flex","justify-content":"between"}},[Q,(0,a.Wm)("span",null,[(0,a.Uk)((0,i.zw)(t["label"])+" ",1),(0,a.Wm)("strong",null,(0,i.zw)(t["value"]),1)])])))),128))])))),128)),((0,a.wg)(!0),(0,a.j4)(a.HY,null,(0,a.Ko)(l.totais,((t,l)=>((0,a.wg)(),(0,a.j4)("div",{key:l,style:{display:"flex","justify-content":"between"}},[H,(0,a.Wm)("span",null,[(0,a.Uk)((0,i.zw)(t["label"])+" ",1),(0,a.Wm)("strong",null,(0,i.zw)(t["value"]),1)])])))),128))])))),128)),((0,a.wg)(!0),(0,a.j4)(a.HY,null,(0,a.Ko)(t.totais,((t,l)=>((0,a.wg)(),(0,a.j4)("div",{key:l,style:{display:"flex","justify-content":"between"}},[K,(0,a.Wm)("span",null,[(0,a.Uk)((0,i.zw)(t["label"])+" ",1),(0,a.Wm)("strong",null,(0,i.zw)(t["value"]),1)])])))),128))])])}e(7070),e(7280),e(107),e(7098);var Y=e(4459),N=e(6699),V=e(3649),L=e(4399),G=(e(2853),e(1959));const E=(0,G.iH)({dataIni:new Date(Date.now()).toLocaleDateString().split("/").reverse().join("-"),dataFim:new Date(Date.now()).toLocaleDateString().split("/").reverse().join("-"),tipo:"SANGRIAS"}),M=[t=>!!t.dataIni&&!!t.dataFim||"Informe o período!"],A=function(t){return t.filter((t=>"SUPRIMENTOS"===this.filtros.tipo&&"C"===t.tipo_emissao||"SANGRIAS"===this.filtros.tipo&&"D"===t.tipo_emissao)).map((t=>{const l=this.$store.state.lojas.ls.find((l=>l.id==t.id)).nome;return{loja:l,caixa:t.caixa,turno:t.turno,hora:new Date(t.hora),anotacao:t.anotacao,valor:parseFloat("SUPRIMENTOS"===this.filtros.tipo?t.suprimento:t.sangria)}}))},P={hora:"Data/hora",valor:"Valor (R$)",anotacao:"anotação"},B={hora:t=>t.toLocaleString("pt-br"),valor:t=>(0,V.im)(t)},J=()=>"",X={},tt=function(t){return[{label:`Total de ${this.filtros.tipo}: `,value:`R$ ${(0,V.im)(t.reduce(((t,l)=>t+l.valor),0))}`}]},lt=function(t){return Object.keys(t).map((l=>({name:l,label:(this.labels[l]||l).toUpperCase(),field:l,align:isNaN(parseInt(t[l]))?"left":"right",sortable:!0,format:this.format[l]})))},et=(0,a.aZ)({name:"SuprimentosSangrias",components:{RelatorioPage:L.Z},data(){return{drawerFilters:!1,totais:[],rows:[],columns:[],tabelas:[],visibleColumns:[],grupos:[],tipoOptions:["SUPRIMENTOS","SANGRIAS"],grupos_ex:[{title:"",totais:[{label:"",value:""}],tabelas:[{title:"",data:[],totais:[]}]}]}},setup:()=>({tipoGerado:"",filtros:E,format:B,labels:P,validate:M,setRows:A,setColumns:lt,setTotais:tt,totaisColunas:X,styles:J}),computed:{printColumns(){return this.columns.filter((t=>this.visibleColumns.includes(t.name)))},printRows(){const t=V.CK.array(this.rows);return t.map((t=>(Object.keys(t).forEach((l=>{this.visibleColumns.includes(l)||delete t[l]})),t)))}},methods:{async gerarRelatorio(){if(!await this.valida())return;const t=await Y.b.gerarRelatorio("sangrias_suprimentos",this.filtros);if(0!==t.length){this.tipoGerado=this.filtros.tipo,this.rows=this.setRows.bind(this)(t),this.columns=this.setColumns.bind(this)(this.rows[0]||{}),this.totais=this.setTotais.bind(this)(this.rows),this.visibleColumns=Object.keys(this.rows[0]),this.visibleColumns.splice(this.visibleColumns.indexOf("loja"),1),this.grupos=this.printRows.reduce(((t,l)=>{const e=t.findIndex((t=>t.caixa===l.caixa));return-1===e&&t.push({title:`Caixa ${l.caixa}`,caixa:l.caixa,tabelas:[],totais:[{label:`Total do caixa ${l.caixa}: `,value:`R$ ${(0,V.im)(this.printRows.filter((t=>t.caixa===l.caixa)).reduce(((t,l)=>t+l.valor),0))}`}]}),t}),[]),this.grupos.sort(((t,l)=>t.caixa>l.caixa?1:-1));for(let t=0;t<this.grupos.length;t++){const l=this.grupos[t];this.printRows.filter((t=>t.caixa===l.caixa)).forEach((t=>{const e=l.tabelas.findIndex((l=>l.turno===t.turno));-1===e?l.tabelas.push({title:`Turno ${t.turno}`,turno:t.turno,data:[t],totais:[{label:`Total no turno ${t.turno}: `,value:`R$ ${(0,V.im)(this.printRows.filter((e=>e.caixa===l.caixa&&e.turno===t.turno)).reduce(((t,l)=>t+l.valor),0))}`}]}):l.tabelas[e].data.push(t)})),l.tabelas.sort(((t,l)=>t.turno>l.turno?1:-1))}console.log(this.grupos)}else this.$q.notify({position:"top",message:"Nenhum registro encontrado!"})},async valida(){const t=this.validate||[];for(let l=0;l<t.length;l++){const e=t[l],a=await e(this.filtros);if("string"===typeof a)return this.$q.notify({type:"negative",message:a}),!1}return!0},closeMenuFiltros(){this.drawerFilters=innerWidth>1200||!this.drawerFilters},exportar(t){let l=V.CK.array(this.rows);l=l.map((t=>Object.keys(t).reduce(((l,e)=>{const a=this.columns.find((t=>t.name===e)),i=(0,V.p3)(t[e]);return l[a.label]=t[e]instanceof Date?new Date(t[e]).toLocaleString("pt-br"):isNaN(i)?t[e]:i,l}),{}))),(0,N.m)(t||0,l)},imprimir(){const t=this.columns;if(t&&t.length>0){const t=document.getElementById("testeimpressao"),l=document.querySelector("#iframe_print");return l.contentWindow.document.open(),l.contentWindow.document.write(t.innerHTML),l.contentWindow.print(),void l.contentWindow.document.close()}this.$q.notify({type:"negative",message:"Nenhum dado para imprimir"})}}});var at=e(2165),it=e(811),ot=e(7011),st=e(3414),nt=e(2035),rt=e(2025),ut=e(5869),mt=e(6429),dt=e(8186),pt=e(3884),ct=e(8870),wt=e(2428),gt=e(9570),ft=e(3747),bt=e(5269),ht=e(4842),yt=e(8516),Wt=e(6489),vt=e(7518),xt=e.n(vt);et.render=O;const jt=et;xt()(et,"components",{QBtn:at.Z,QMenu:it.Z,QList:ot.Z,QItem:st.Z,QItemSection:nt.Z,QSpace:rt.Z,QSeparator:ut.Z,QTable:mt.Z,QTr:dt.Z,QTd:pt.Z,QTooltip:ct.Z,QDrawer:wt.Z,QToolbar:gt.Z,QToolbarTitle:ft.Z,QForm:bt.Z,QInput:ht.Z,QSelect:yt.Z}),xt()(et,"directives",{Ripple:Wt.Z})}}]);