(self["webpackChunkret"]=self["webpackChunkret"]||[]).push([[330],{7330:(l,t,e)=>{"use strict";e.r(t),e.d(t,{default:()=>vl});var a=e(3673),n=e(2323),s=e(8880);const o={class:"q-pa-md"},i=(0,a.Wm)("div",{class:"flex justify-between"},[(0,a.Wm)("span",{class:"text-blue text-h5"},"Cancelamentos")],-1),r=(0,a.Wm)("br",null,null,-1),m={class:"flex items-center"},u=(0,a.Wm)("span",{class:"gt-sm q-pl-sm"},"Imprimir",-1),d=(0,a.Wm)("span",{class:"gt-sm q-pl-sm"},"Exportar",-1),c=(0,a.Wm)("span",null,"Excel",-1),p=(0,a.Wm)("span",null,"Planilhas Online",-1),w=(0,a.Wm)("br",null,null,-1),f=(0,a.Wm)("br",null,null,-1),g={class:"q-pa-md bg-grey-1 radius-10 text-blue text-bold"},b=(0,a.Wm)("br",null,null,-1),h={style:{display:"flex",width:"100%"}},y=(0,a.Wm)("div",{style:{flex:"1"}},null,-1),W=(0,a.Uk)(" FILTROS "),v=(0,a.Wm)("label",null,"Data Início",-1),k=(0,a.Wm)("br",null,null,-1),x=(0,a.Wm)("label",null,"Data Fim",-1),j=(0,a.Wm)("br",null,null,-1),C=(0,a.Uk)(" Gerar relatório "),q=(0,a.Wm)("iframe",{id:"iframe_print",style:{display:"none"}},null,-1),_={id:"testeimpressao",style:{display:"none"}},z={style:{display:"flex","justify-content":"start","align-items":"center",color:"#70a0ff","font-family":"sans-serif"}},F={style:{padding:"10px"}},Z=(0,a.Wm)("h2",null,"Cancelamentos",-1),H={style:{display:"flex","justify-content":"flex-end","font-size":"14px","font-weight":"bold",color:"#70a0ff"}},K=(0,a.Wm)("div",{style:{width:"100%",height:"1px","background-color":"#70a0ff"}},null,-1),Q={style:{padding:"10px",color:"#70a0ff","font-weigth":"600","font-size":"24px"}},T=(0,a.Wm)("br",null,null,-1),$={style:{padding:"10px",color:"#70a0ff","font-weigth":"600","font-size":"18px"}},I=(0,a.Wm)("br",null,null,-1),U=(0,a.Wm)("div",{style:{flex:"1"}},null,-1),Y=(0,a.Wm)("div",{style:{flex:"1"}},null,-1),R=(0,a.Wm)("div",{style:{flex:"1"}},null,-1);function D(l,t,e,D,S,L){const O=(0,a.up)("q-btn"),V=(0,a.up)("q-item-section"),N=(0,a.up)("q-item"),E=(0,a.up)("q-list"),M=(0,a.up)("q-menu"),P=(0,a.up)("q-space"),G=(0,a.up)("q-separator"),B=(0,a.up)("q-td"),A=(0,a.up)("q-tr"),J=(0,a.up)("q-tooltip"),X=(0,a.up)("q-table"),ll=(0,a.up)("q-toolbar-title"),tl=(0,a.up)("q-toolbar"),el=(0,a.up)("q-input"),al=(0,a.up)("q-form"),nl=(0,a.up)("q-drawer"),sl=(0,a.Q2)("ripple");return(0,a.wg)(),(0,a.j4)("div",o,[i,r,(0,a.Wm)("div",m,[(0,a.Wm)(O,{class:"q-mb-sm bg-blue text-white on-left",icon:"print",onClick:l.imprimir},{default:(0,a.w5)((()=>[u])),_:1},8,["onClick"]),(0,a.Wm)(O,{class:"q-mb-sm bg-blue text-white on-left",icon:"file_download"},{default:(0,a.w5)((()=>[d,(0,a.Wm)(M,null,{default:(0,a.w5)((()=>[(0,a.Wm)(E,null,{default:(0,a.w5)((()=>[(0,a.Wm)(N,{clickable:"",onClick:t[1]||(t[1]=t=>l.exportar(0))},{default:(0,a.w5)((()=>[(0,a.Wm)(V,null,{default:(0,a.w5)((()=>[c])),_:1})])),_:1}),(0,a.Wm)(N,{clickable:"",onClick:t[2]||(t[2]=t=>l.exportar(1))},{default:(0,a.w5)((()=>[(0,a.Wm)(V,null,{default:(0,a.w5)((()=>[p])),_:1})])),_:1})])),_:1})])),_:1})])),_:1}),(0,a.Wm)(P),(0,a.Wm)(O,{icon:"filter_list",label:"",class:"text-white bg-blue q-mb-sm",onClick:t[3]||(t[3]=t=>l.drawerFilters=!l.drawerFilters)})]),w,f,((0,a.wg)(!0),(0,a.j4)(a.HY,null,(0,a.Ko)(l.grupos,((t,e)=>((0,a.wg)(),(0,a.j4)("div",{key:e,class:"bg-grey-4 radius-10 q-mb-xl"},[(0,a.Wm)("span",g,(0,n.zw)(t.title),1),(0,a.Wm)(G,{class:"bg-grey-4"}),b,((0,a.wg)(!0),(0,a.j4)(a.HY,null,(0,a.Ko)(t.tabelas,((t,e)=>((0,a.wg)(),(0,a.j4)("div",{key:e},[(0,a.Wm)(X,{separator:"none",rows:t.data,columns:l.columns,title:t.title,"rows-per-page-options":[0],visibleColumns:l.visibleColumns,class:"card q-mb-sm"},(0,a.Nv)({body:(0,a.w5)((t=>[(0,a.Wm)(A,{props:t},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.j4)(a.HY,null,(0,a.Ko)(l.columns.map((l=>l.name)).filter((t=>l.visibleColumns.includes(t))),(e=>((0,a.wg)(),(0,a.j4)(B,{key:e,align:l.columns.find((l=>l.name===e)).align||"",style:`width: calc(100vw / ${l.columns.filter((t=>l.visibleColumns.includes(t))).length}); padding: 10px; ${l.styles(t.row)}`},{default:(0,a.w5)((()=>[(0,a.Uk)((0,n.zw)(l.columns.find((l=>l.name===e)).format?l.columns.find((l=>l.name===e)).format(t.row[e],t.row):t.row[e]),1)])),_:2},1032,["align","style"])))),128))])),_:2},1032,["props"])])),bottom:(0,a.w5)((()=>[(0,a.Wm)("div",h,[y,(0,a.Wm)("span",null,(0,n.zw)(t.data.length)+" cancelamento(s)",1)])])),_:2},[Object.keys(l.totaisColunas).length>0?{name:"bottom-row",fn:(0,a.w5)((t=>[(0,a.Wm)(A,{class:"bg-grey-3",props:t},{default:(0,a.w5)((()=>[((0,a.wg)(!0),(0,a.j4)(a.HY,null,(0,a.Ko)(t.cols.map((l=>l.name)),(t=>((0,a.wg)(),(0,a.j4)(B,{align:"right",key:t,class:"text-bold",style:{"font-size":"12px",padding:"10px"}},{default:(0,a.w5)((()=>[(0,a.Uk)((0,n.zw)(l.totaisColunas[t]?l.totaisColunas[t](l.rows):"")+" ",1),l.totaisColunas[t]?((0,a.wg)(),(0,a.j4)(J,{key:0},{default:(0,a.w5)((()=>[(0,a.Uk)(" TOTAL "+(0,n.zw)(l.columns.find((l=>l.name===t)).label),1)])),_:2},1024)):(0,a.kq)("",!0)])),_:2},1024)))),128))])),_:2},1032,["props"])]))}:void 0]),1032,["rows","columns","title","visibleColumns"]),((0,a.wg)(!0),(0,a.j4)(a.HY,null,(0,a.Ko)(t.totais,((l,t)=>((0,a.wg)(),(0,a.j4)("div",{key:t,class:"card q-pa-md q-mb-md bg-white",align:"right"},[(0,a.Wm)("span",null,[(0,a.Uk)((0,n.zw)(l["label"])+" ",1),(0,a.Wm)("strong",null,(0,n.zw)(l["value"]),1)])])))),128))])))),128)),((0,a.wg)(!0),(0,a.j4)(a.HY,null,(0,a.Ko)(t.totais,((l,t)=>((0,a.wg)(),(0,a.j4)("div",{key:t,class:"card q-pa-md q-mb-md bg-white",align:"right"},[(0,a.Wm)("span",null,[(0,a.Uk)((0,n.zw)(l["label"])+" ",1),(0,a.Wm)("strong",null,(0,n.zw)(l["value"]),1)])])))),128))])))),128)),((0,a.wg)(!0),(0,a.j4)(a.HY,null,(0,a.Ko)(l.totais,((l,t)=>((0,a.wg)(),(0,a.j4)("div",{key:t,class:"card q-pa-md q-mb-md bg-white",align:"right"},[(0,a.Wm)("span",null,[(0,a.Uk)((0,n.zw)(l["label"])+" ",1),(0,a.Wm)("strong",null,(0,n.zw)(l["value"]),1)])])))),128)),(0,a.Wm)(nl,{"show-if-above":"",modelValue:l.drawerFilters,"onUpdate:modelValue":t[6]||(t[6]=t=>l.drawerFilters=t),side:"right"},{default:(0,a.w5)((()=>[(0,a.Wm)(tl,null,{default:(0,a.w5)((()=>[(0,a.Wm)(ll,null,{default:(0,a.w5)((()=>[W])),_:1})])),_:1}),(0,a.Wm)(E,null,{default:(0,a.w5)((()=>[(0,a.Wm)(N,null,{default:(0,a.w5)((()=>[(0,a.Wm)(V,null,{default:(0,a.w5)((()=>[(0,a.Wm)(al,{onSubmit:(0,s.iM)(l.gerarRelatorio,["prevent","stop"]),style:{width:"100%","max-width":"400px"}},{default:(0,a.w5)((()=>[v,(0,a.Wm)(el,{type:"date",filled:"",modelValue:l.filtros.dataIni,"onUpdate:modelValue":t[4]||(t[4]=t=>l.filtros.dataIni=t)},null,8,["modelValue"]),k,x,(0,a.Wm)(el,{type:"date",filled:"",modelValue:l.filtros.dataFim,"onUpdate:modelValue":t[5]||(t[5]=t=>l.filtros.dataFim=t)},null,8,["modelValue"]),j,(0,a.wy)((0,a.Wm)(O,{color:"blue",class:"q-pa-md",type:"submit",style:{width:"100%"},onClick:l.closeMenuFiltros},{default:(0,a.w5)((()=>[C])),_:1},8,["onClick"]),[[sl]])])),_:1},8,["onSubmit"])])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"]),q,(0,a.Wm)("div",_,[(0,a.Wm)("div",z,[(0,a.Wm)("img",{src:"https://www.lsiconsultoria.com.br/images/logotipo_galileo_plus.png",alt:"Logotipo Galileo Plus",style:"height: 75.2px; width: 200px;"},null,4),(0,a.Wm)("div",F,[Z,(0,a.Wm)("div",H,[(0,a.Wm)("span",null," Período: "+(0,n.zw)(new Date(`${l.filtros.dataIni} `).toLocaleDateString("pt-br"))+" - "+(0,n.zw)(new Date(`${l.filtros.dataFim} `).toLocaleDateString("pt-br")),1),(0,a.Wm)("span",null," | Gerado: "+(0,n.zw)(new Date(Date.now()).toLocaleString("pt-br"))+" por "+(0,n.zw)(l.$store.state.user.nome),1)])])]),K,((0,a.wg)(!0),(0,a.j4)(a.HY,null,(0,a.Ko)(l.grupos,((t,e)=>((0,a.wg)(),(0,a.j4)("div",{key:e,style:{margin:"20px"}},[(0,a.Wm)("span",Q,(0,n.zw)(t.title),1),T,((0,a.wg)(!0),(0,a.j4)(a.HY,null,(0,a.Ko)(t.tabelas,((t,e)=>((0,a.wg)(),(0,a.j4)("div",{key:e},[(0,a.Wm)("div",$,[I,(0,a.Wm)("span",null,(0,n.zw)(t.title),1)]),(0,a.Wm)("table",{style:`width: 100vw; font-size: calc(100% - ${l.printColumns.length/2}px);`},[(0,a.Wm)("thead",null,[(0,a.Wm)("tr",null,[((0,a.wg)(!0),(0,a.j4)(a.HY,null,(0,a.Ko)(l.printColumns,(t=>((0,a.wg)(),(0,a.j4)("th",{align:t.align,key:t.name,style:`width: calc(100vw / ${l.printColumns.length}); padding: 10px; background-color: #70a0ff99; color: #fff; `},(0,n.zw)(t.label),13,["align"])))),128))])]),(0,a.Wm)("tbody",null,[((0,a.wg)(!0),(0,a.j4)(a.HY,null,(0,a.Ko)(t.data,((t,e)=>((0,a.wg)(),(0,a.j4)("tr",{key:e,style:{height:"35px"}},[((0,a.wg)(!0),(0,a.j4)(a.HY,null,(0,a.Ko)(Object.keys(t),((e,s)=>((0,a.wg)(),(0,a.j4)("td",{key:e,align:l.printColumns[s].align,style:`border-bottom: 1px solid #c0c0c0; width: calc(100vw / ${l.printColumns.length}); padding: 10px; ${l.styles(t)}`},(0,n.zw)(l.printColumns[s].format?l.printColumns[s].format(t[e],t):t[e]),13,["align"])))),128))])))),128))])],4),((0,a.wg)(!0),(0,a.j4)(a.HY,null,(0,a.Ko)(t.totais,((l,t)=>((0,a.wg)(),(0,a.j4)("div",{key:t,style:{display:"flex","justify-content":"between"}},[U,(0,a.Wm)("span",null,[(0,a.Uk)((0,n.zw)(l["label"])+" ",1),(0,a.Wm)("strong",null,(0,n.zw)(l["value"]),1)])])))),128))])))),128)),((0,a.wg)(!0),(0,a.j4)(a.HY,null,(0,a.Ko)(t.totais,((l,t)=>((0,a.wg)(),(0,a.j4)("div",{key:t,style:{display:"flex","justify-content":"between"}},[Y,(0,a.Wm)("span",null,[(0,a.Uk)((0,n.zw)(l["label"])+" ",1),(0,a.Wm)("strong",null,(0,n.zw)(l["value"]),1)])])))),128))])))),128)),((0,a.wg)(!0),(0,a.j4)(a.HY,null,(0,a.Ko)(l.totais,((l,t)=>((0,a.wg)(),(0,a.j4)("div",{key:t,style:{display:"flex","justify-content":"between"}},[R,(0,a.Wm)("span",null,[(0,a.Uk)((0,n.zw)(l["label"])+" ",1),(0,a.Wm)("strong",null,(0,n.zw)(l["value"]),1)])])))),128))])])}e(107);var S=e(4459),L=e(6699),O=e(3649),V=e(4399),N=(e(2853),e(1959));const E=(0,N.iH)({dataIni:(0,O.C3)(0,3).inicio,dataFim:(0,O.C3)(0,3).fim}),M=[l=>!!l.dataIni&&!!l.dataFim||"Informe o período!"],P=function(l){return l.map((l=>{const t=this.$store.state.lojas.ls.find((t=>t.id==l.id)).nome;return{loja:t,local:l.local,nome:l.nome,data_canc:new Date(l.data_canc),descricao:l.descricao,valor:parseFloat(l.valor)}}))},G={data_canc:"Data",valor:"Valor (R$)"},B={data_canc:l=>l.toLocaleString("pt-br"),valor:l=>(0,O.im)(l)},A=()=>"",J={},X=function(l){return[{label:"Total de cancelamentos: ",value:(0,O.im)(l.reduce(((l,t)=>l+parseFloat(t.valor)),0))}]},ll=function(l){return Object.keys(l).map((t=>({name:t,label:(this.labels[t]||t).toUpperCase(),field:t,align:isNaN(parseInt(l[t]))?"left":"right",sortable:!0,format:this.format[t]})))},tl=(0,a.aZ)({name:"Cancelamentos",components:{RelatorioPage:V.Z},data(){return{drawerFilters:!1,totais:[],rows:[],columns:[],tabelas:[],grupos:[],visibleColumns:[]}},setup:()=>({filtros:E,format:B,labels:G,validate:M,setRows:P,setColumns:ll,setTotais:X,totaisColunas:J,styles:A}),computed:{printColumns(){return this.columns.filter((l=>this.visibleColumns.includes(l.name)))},printRows(){const l=O.CK.array(this.rows);return l.map((l=>(Object.keys(l).forEach((t=>{this.visibleColumns.includes(t)||delete l[t]})),l)))}},methods:{async gerarRelatorio(){if(!await this.valida())return;const l=await S.b.gerarRelatorio("cancelamentos",this.filtros);this.rows=this.setRows.bind(this)(l),this.columns=this.setColumns.bind(this)(this.rows[0]||{}),this.totais=this.setTotais.bind(this)(this.rows),this.visibleColumns=Object.keys(this.rows[0]),this.visibleColumns.splice(this.visibleColumns.indexOf("loja"),1),this.grupos=this.printRows.reduce(((l,t)=>{const e=l.findIndex((l=>l["local"]===t.local));return-1===e&&l.push({title:`Cancelamentos no ${t["local"]}`,local:t["local"],tabelas:[],totais:[{label:`Total no local "${t["local"]}": `,value:(0,O.im)(this.printRows.filter((l=>l.local===t["local"])).reduce(((l,t)=>l+parseFloat(t.valor)),0))}]}),l}),[]);for(let t=0;t<this.grupos.length;t++){const l=this.grupos[t];this.printRows.filter((t=>t.local===l.local)).forEach((t=>{const e=l.tabelas.find((l=>l.title===t["nome"]));e?e.data.push(t):l.tabelas.push({title:t["nome"],data:[t],totais:[{label:`Total de ${t["nome"]}: `,value:(0,O.im)(this.printRows.filter((e=>e.local===l.local&&e.nome===t["nome"])).reduce(((l,t)=>l+parseFloat(t.valor)),0))}]})}))}},async valida(){const l=this.validate||[];for(let t=0;t<l.length;t++){const e=l[t],a=await e(this.filtros);if("string"===typeof a)return this.$q.notify({type:"negative",message:a}),!1}return!0},closeMenuFiltros(){this.drawerFilters=innerWidth>1200||!this.drawerFilters},exportar(l){let t=O.CK.array(this.rows);t=t.map((l=>Object.keys(l).reduce(((t,e)=>{const a=this.columns.find((l=>l.name===e)),n=(0,O.p3)(l[e]);return t[a.label]="data_canc"===e?new Date(l[e]).toLocaleString("pt-br"):isNaN(n)?l[e]:n,t}),{}))),(0,L.m)(l||0,t)},imprimir(){const l=this.columns;if(l&&l.length>0){const l=document.getElementById("testeimpressao"),t=document.querySelector("#iframe_print");return t.contentWindow.document.open(),t.contentWindow.document.write(l.innerHTML),t.contentWindow.print(),void t.contentWindow.document.close()}this.$q.notify({type:"negative",message:"Nenhum dado para imprimir"})}}});var el=e(2165),al=e(811),nl=e(7011),sl=e(3414),ol=e(2035),il=e(2025),rl=e(5869),ml=e(6429),ul=e(8186),dl=e(3884),cl=e(8870),pl=e(2428),wl=e(9570),fl=e(3747),gl=e(5269),bl=e(4842),hl=e(6489),yl=e(7518),Wl=e.n(yl);tl.render=D;const vl=tl;Wl()(tl,"components",{QBtn:el.Z,QMenu:al.Z,QList:nl.Z,QItem:sl.Z,QItemSection:ol.Z,QSpace:il.Z,QSeparator:rl.Z,QTable:ml.Z,QTr:ul.Z,QTd:dl.Z,QTooltip:cl.Z,QDrawer:pl.Z,QToolbar:wl.Z,QToolbarTitle:fl.Z,QForm:gl.Z,QInput:bl.Z}),Wl()(tl,"directives",{Ripple:hl.Z})}}]);