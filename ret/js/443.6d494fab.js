(self["webpackChunkret"]=self["webpackChunkret"]||[]).push([[443],{4443:(t,o,e)=>{"use strict";e.r(o),e.d(o,{default:()=>L});var l=e(3673),r=e(8880);const s=(0,l.Uk)(" FILTROS "),a=(0,l.Wm)("label",null,"Data Início",-1),i=(0,l.Wm)("br",null,null,-1),u=(0,l.Wm)("label",null,"Data Fim",-1),n=(0,l.Wm)("br",null,null,-1),d=(0,l.Wm)("label",null,"Grupo",-1),p=(0,l.Wm)("br",null,null,-1),m=(0,l.Wm)("label",null,"Subgrupo",-1),c=(0,l.Wm)("br",null,null,-1),f=(0,l.Wm)("label",null,"Produto",-1),b=(0,l.Wm)("br",null,null,-1),O=(0,l.Uk)(" Gerar relatório ");function h(t,o,e,h,g,S){const w=(0,l.up)("RelatorioPage"),F=(0,l.up)("q-toolbar-title"),U=(0,l.up)("q-toolbar"),T=(0,l.up)("q-input"),V=(0,l.up)("q-select"),W=(0,l.up)("q-btn"),D=(0,l.up)("q-form"),R=(0,l.up)("q-item-section"),v=(0,l.up)("q-item"),P=(0,l.up)("q-list"),y=(0,l.up)("q-drawer"),q=(0,l.Q2)("ripple");return(0,l.wg)(),(0,l.j4)("div",null,[(0,l.Wm)(w,{rows:t.rows,columns:t.columns,totais:t.totais,styles:t.styles,filtros:t.filtros,title:"Curva ABC",onToggleDrawerFilters:o[1]||(o[1]=o=>t.drawerFilters=!t.drawerFilters)},null,8,["rows","columns","totais","styles","filtros"]),(0,l.Wm)(y,{"show-if-above":"",modelValue:t.drawerFilters,"onUpdate:modelValue":o[8]||(o[8]=o=>t.drawerFilters=o),side:"right"},{default:(0,l.w5)((()=>[(0,l.Wm)(U,null,{default:(0,l.w5)((()=>[(0,l.Wm)(F,null,{default:(0,l.w5)((()=>[s])),_:1})])),_:1}),(0,l.Wm)(P,null,{default:(0,l.w5)((()=>[(0,l.Wm)(v,null,{default:(0,l.w5)((()=>[(0,l.Wm)(R,null,{default:(0,l.w5)((()=>[(0,l.Wm)(D,{onSubmit:(0,r.iM)(t.gerarRelatorio,["prevent","stop"]),style:{width:"100%","max-width":"400px"}},{default:(0,l.w5)((()=>[a,(0,l.Wm)(T,{type:"date",filled:"",modelValue:t.filtros.dataIni,"onUpdate:modelValue":o[2]||(o[2]=o=>t.filtros.dataIni=o)},null,8,["modelValue"]),i,u,(0,l.Wm)(T,{type:"date",filled:"",modelValue:t.filtros.dataFim,"onUpdate:modelValue":o[3]||(o[3]=o=>t.filtros.dataFim=o)},null,8,["modelValue"]),n,d,(0,l.Wm)(V,{filled:"",options:t.grupos,modelValue:t.filtros.grupo,"onUpdate:modelValue":[o[4]||(o[4]=o=>t.filtros.grupo=o),t.getSubgrupos]},null,8,["options","modelValue","onUpdate:modelValue"]),p,m,(0,l.Wm)(V,{filled:"",disable:"TODOS OS GRUPOS"===t.filtros.grupo,options:t.subgrupos,modelValue:t.filtros.subgrupo,"onUpdate:modelValue":[o[5]||(o[5]=o=>t.filtros.subgrupo=o),t.getProdutos]},null,8,["disable","options","modelValue","onUpdate:modelValue"]),c,f,(0,l.Wm)(V,{filled:"",disable:"TODOS OS SUBGRUPOS"===t.filtros.subgrupo,"input-debounce":0,options:t.produtosFiltrado,modelValue:t.filtros.produto,"onUpdate:modelValue":o[6]||(o[6]=o=>t.filtros.produto=o),"use-input":"",onFilter:t.filterProduto,onFocus:o[7]||(o[7]=o=>t.filtros.produto=""),style:{"text-transform":"uppercase"}},null,8,["disable","options","modelValue","onFilter"]),b,(0,l.wy)((0,l.Wm)(W,{color:"blue",class:"q-pa-md",type:"submit",style:{width:"100%"},onClick:t.closeMenuFiltros},{default:(0,l.w5)((()=>[O])),_:1},8,["onClick"]),[[q]])])),_:1},8,["onSubmit"])])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])])}e(7098),e(7280),e(5363),e(71);var g=e(1959),S=e(4459),w=e(4399),F=e(3649);const U=(0,g.iH)({dataIni:(0,F.C3)(0,3).inicio,dataFim:(0,F.C3)(0,3).fim,grupo:"TODOS OS GRUPOS",subgrupo:"TODOS OS SUBGRUPOS",produto:"TODOS OS PRODUTOS"}),T=[t=>!!t.dataIni&&!!t.dataFim||"Informe o período!"],V=function(t){return t.sort(((t,o)=>t.curva<o.curva?-1:1)),t.map((t=>{const o=this.$store.state.lojas.ls.find((o=>o.id==t.id)).nome;return{curva:t.curva,loja:o||"",descricao:t.descricao||"",totalVendas:parseFloat(t.valoritem||"0"),quantidade:parseFloat(t.quantidade||"0"),und:t.und||"",vendas:parseFloat(t.vendas||"0"),percentualItem:(0,F.p3)(t.percentualitem)}}))},W={totalVendas:t=>(0,F.im)(t),percentualAcumulado:t=>parseFloat(t).toFixed(2),percentualItem:t=>parseFloat(t).toFixed(2),quantidade:(t,o)=>"KG"!==o.und?t:parseFloat(t).toFixed(3).replace(".",","),vendas:t=>0===t?"":t.toString()},D={totalVendas:"TOTAL VENDAS (R$)",percentualItem:"% ITEM"},R=t=>{switch(t.curva){case"A":return"color: #03d100; background-color: #8affa310";case"B":return"color: #ffaa00; background-color: #ffcb6b10";case"C":return"color: #ff0000; background-color: #ff8a8a10";default:return""}},v=function(t){return Object.keys(t).map((o=>({name:o,label:this.labels[o]||o.toUpperCase(),field:o,align:isNaN(parseInt(t[o]))?"left":"right",sortable:!0,format:this.format[o]})))},P=function(t){return[]},y=(0,l.aZ)({name:"RankingDeVendas",components:{RelatorioPage:w.Z},setup:()=>({filtros:U,format:W,labels:D,validate:T,setRows:V,setColumns:v,setTotais:P,styles:R}),data(){return{drawerFilters:!1,totais:[],rows:[],columns:[],grupos:[],subgrupos:[],produtos:[],produtosFiltrado:[]}},async mounted(){this.grupos=["TODOS OS GRUPOS",...await S.b.getGrupos()]},methods:{filterProduto(t,o){o(""!==t?()=>{this.produtosFiltrado=this.produtos.filter((o=>o.toUpperCase().includes(t.toUpperCase())))}:()=>{this.produtosFiltrado=this.produtos})},async getSubgrupos(t){this.filtros.produto="TODOS OS PRODUTOS";const o=await S.b.getSubgrupos(t||"");this.subgrupos=1===o.length?o:["TODOS OS SUBGRUPOS",...o],this.filtros.subgrupo=1===this.subgrupos.length?this.subgrupos[0]:"TODOS OS SUBGRUPOS",this.getProdutos()},async getProdutos(){if("TODOS OS GRUPOS"===this.filtros.grupo)return;const t=await S.b.getProdutos(this.filtros.grupo,this.filtros.subgrupo);this.produtos=1===t.length?t:["TODOS OS PRODUTOS",...t],this.filtros.produto=1===this.produtos.length?this.produtos[0]:"TODOS OS PRODUTOS"},async gerarRelatorio(){if(!await this.valida())return;this.filtros.produto=this.filtros.produto?this.filtros.produto:"TODOS OS PRODUTOS";const t=await S.b.gerarRelatorio("curva_abc",this.filtros);this.rows=this.setRows.bind(this)(t),this.columns=this.setColumns.bind(this)(this.rows[0]||{}),this.totais=this.setTotais.bind(this)(this.rows)},async valida(){const t=this.validate||[];for(let o=0;o<t.length;o++){const e=t[o],l=await e(this.filtros);if("string"===typeof l)return this.$q.notify({type:"negative",message:l}),!1}return!0},closeMenuFiltros(){this.drawerFilters=innerWidth>1200||!this.drawerFilters}}});var q=e(2428),I=e(9570),C=e(3747),k=e(7011),Z=e(3414),G=e(2035),Q=e(5269),_=e(4842),B=e(8516),x=e(2165),A=e(6489),j=e(7518),M=e.n(j);y.render=h;const L=y;M()(y,"components",{QDrawer:q.Z,QToolbar:I.Z,QToolbarTitle:C.Z,QList:k.Z,QItem:Z.Z,QItemSection:G.Z,QForm:Q.Z,QInput:_.Z,QSelect:B.Z,QBtn:x.Z}),M()(y,"directives",{Ripple:A.Z})}}]);