(self["webpackChunkret"]=self["webpackChunkret"]||[]).push([[137],{137:(l,e,t)=>{"use strict";t.r(e),t.d(e,{default:()=>N});var o=t(3673),a=t(8880);const s=(0,o.Uk)(" FILTROS "),i=(0,o.Wm)("label",null,"Data Início",-1),r={style:{display:"flex"}},u=(0,o.Wm)("br",null,null,-1),n=(0,o.Wm)("label",null,"Data Fim",-1),d={style:{display:"flex"}},m=(0,o.Wm)("br",null,null,-1),p=(0,o.Wm)("label",null,"Grupo",-1),f=(0,o.Wm)("br",null,null,-1),b=(0,o.Wm)("label",null,"Subgrupo",-1),c=(0,o.Wm)("br",null,null,-1),h=(0,o.Wm)("label",null,"Ordem",-1),g=(0,o.Wm)("br",null,null,-1),w=(0,o.Uk)(" Gerar relatório ");function O(l,e,t,O,S,V){const W=(0,o.up)("RelatorioPage"),F=(0,o.up)("q-toolbar-title"),y=(0,o.up)("q-toolbar"),U=(0,o.up)("q-input"),R=(0,o.up)("q-select"),v=(0,o.up)("q-btn"),I=(0,o.up)("q-form"),q=(0,o.up)("q-item-section"),T=(0,o.up)("q-item"),D=(0,o.up)("q-list"),Z=(0,o.up)("q-drawer"),k=(0,o.Q2)("ripple");return(0,o.wg)(),(0,o.j4)("div",null,[(0,o.Wm)(W,{rows:l.rows,columns:l.columns,totais:l.totais,filtros:l.filtros,title:"Ranking de Vendas",onToggleDrawerFilters:e[1]||(e[1]=e=>l.drawerFilters=!l.drawerFilters)},null,8,["rows","columns","totais","filtros"]),(0,o.Wm)(Z,{"show-if-above":"",modelValue:l.drawerFilters,"onUpdate:modelValue":e[9]||(e[9]=e=>l.drawerFilters=e),side:"right"},{default:(0,o.w5)((()=>[(0,o.Wm)(y,null,{default:(0,o.w5)((()=>[(0,o.Wm)(F,null,{default:(0,o.w5)((()=>[s])),_:1})])),_:1}),(0,o.Wm)(D,null,{default:(0,o.w5)((()=>[(0,o.Wm)(T,null,{default:(0,o.w5)((()=>[(0,o.Wm)(q,null,{default:(0,o.w5)((()=>[(0,o.Wm)(I,{onSubmit:(0,a.iM)(l.gerarRelatorio,["prevent","stop"]),style:{width:"100%","max-width":"400px"}},{default:(0,o.w5)((()=>[i,(0,o.Wm)("div",r,[(0,o.Wm)(U,{type:"date",filled:"",modelValue:l.filtros.dataIni,"onUpdate:modelValue":e[2]||(e[2]=e=>l.filtros.dataIni=e),style:{flex:"1"}},null,8,["modelValue"]),(0,o.Wm)(U,{type:"time",filled:"",modelValue:l.filtros.horaIni,"onUpdate:modelValue":e[3]||(e[3]=e=>l.filtros.horaIni=e)},null,8,["modelValue"])]),u,n,(0,o.Wm)("div",d,[(0,o.Wm)(U,{type:"date",filled:"",modelValue:l.filtros.dataFim,"onUpdate:modelValue":e[4]||(e[4]=e=>l.filtros.dataFim=e),style:{flex:"1"}},null,8,["modelValue"]),(0,o.Wm)(U,{type:"time",filled:"",modelValue:l.filtros.horaFim,"onUpdate:modelValue":e[5]||(e[5]=e=>l.filtros.horaFim=e)},null,8,["modelValue"])]),m,p,(0,o.Wm)(R,{filled:"",options:l.grupos,modelValue:l.filtros.grupo,"onUpdate:modelValue":[e[6]||(e[6]=e=>l.filtros.grupo=e),l.getSubgrupos]},null,8,["options","modelValue","onUpdate:modelValue"]),f,b,(0,o.Wm)(R,{filled:"",disable:"TODOS OS GRUPOS"===l.filtros.grupo,options:l.subgrupos,modelValue:l.filtros.subgrupo,"onUpdate:modelValue":e[7]||(e[7]=e=>l.filtros.subgrupo=e)},null,8,["disable","options","modelValue"]),c,h,(0,o.Wm)(R,{filled:"",options:["VALOR","QUANTIDADE","NOME"],modelValue:l.filtros.ordem,"onUpdate:modelValue":e[8]||(e[8]=e=>l.filtros.ordem=e)},null,8,["modelValue"]),g,(0,o.wy)((0,o.Wm)(v,{color:"blue",class:"q-pa-md",type:"submit",style:{width:"100%"},onClick:l.closeMenuFiltros},{default:(0,o.w5)((()=>[w])),_:1},8,["onClick"]),[[k]])])),_:1},8,["onSubmit"])])),_:1})])),_:1})])),_:1})])),_:1},8,["modelValue"])])}t(71);var S=t(1959),V=t(4459),W=t(4399),F=t(3649);const y=(0,S.iH)({dataIni:(0,F.C3)(0,3).inicio,dataFim:(0,F.C3)(0,3).fim,horaIni:"00:00",horaFim:"23:59",grupo:"TODOS OS GRUPOS",subgrupo:"TODOS OS SUBGRUPOS",ordem:"VALOR"}),U=[l=>!!l.dataIni&&!!l.dataFim||"Informe o período!"],R={valor:l=>(0,F.im)(l)},v={valor:"VALOR (R$)"},I=function(l){return l.map((l=>{const e=this.$store.state.lojas.ls.find((e=>e.id==l.id)).nome;return{loja:e||"",descricao:l.descricao||"",valor:parseFloat(parseFloat(l.vl_total||"0").toFixed(2)),quantidade:parseFloat(parseFloat(l.qntd||"0").toFixed(2))}}))},q=function(l){return Object.keys(l).map((e=>({name:e,label:(this.labels[e]||e).toUpperCase(),field:e,align:isNaN(parseInt(l[e]))?"left":"right",sortable:!0,format:this.format[e]})))},T=function(l){return[]},D=(0,o.aZ)({name:"RankingDeVendas",components:{RelatorioPage:W.Z},setup:()=>{const l=(0,S.iH)([]);return{subgrupos:l,filtros:y,format:R,labels:v,validate:U,setRows:I,setColumns:q,setTotais:T}},data(){return{drawerFilters:!1,totais:[],rows:[],columns:[],grupos:[]}},async mounted(){this.grupos=["TODOS OS GRUPOS",...await V.b.getGrupos()]},methods:{async getSubgrupos(l){const e=await V.b.getSubgrupos(l||"");this.subgrupos=1===e.length?e:["TODOS OS SUBGRUPOS",...e],this.filtros.subgrupo=1===this.subgrupos.length?this.subgrupos[0]:"TODOS OS SUBGRUPOS"},async gerarRelatorio(){if(!await this.valida())return;const l=await V.b.gerarRelatorio("ranking_de_vendas",this.filtros);this.rows=this.setRows.bind(this)(l),this.columns=this.setColumns.bind(this)(this.rows[0]||{}),this.totais=this.setTotais.bind(this)(this.rows)},async valida(){const l=this.validate||[];for(let e=0;e<l.length;e++){const t=l[e],o=await t(this.filtros);if("string"===typeof o)return this.$q.notify({type:"negative",message:o}),!1}return!0},closeMenuFiltros(){this.drawerFilters=innerWidth>1200||!this.drawerFilters}}});var Z=t(2428),k=t(9570),Q=t(3747),_=t(7011),C=t(3414),G=t(2035),x=t(5269),P=t(4842),A=t(8516),L=t(2165),j=t(6489),B=t(7518),M=t.n(B);D.render=O;const N=D;M()(D,"components",{QDrawer:Z.Z,QToolbar:k.Z,QToolbarTitle:Q.Z,QList:_.Z,QItem:C.Z,QItemSection:G.Z,QForm:x.Z,QInput:P.Z,QSelect:A.Z,QBtn:L.Z}),M()(D,"directives",{Ripple:j.Z})}}]);